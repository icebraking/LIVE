<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ICE Braking | F1 Standings</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    :root {
      --background: #FF00FF; /* Fuchsia */
      --tab-selected-font: #FFFFFF; /* White for selected tab and header */
      --tab-unselected-font: #FFFFFF;
      --tab-bg: rgba(255,255,255,0.13);
      --tab-selected-bg: rgba(255,255,255,0.28);
      --card-bg: rgba(255,255,255,0.09);
      --table-bg: #FF00FF;
      --row-even: #FF00FF;
      --row-odd: #E100E1;
      --row-accent: #C800C8;
      --accent: #FFFFFF;
      --header-fuchsia: #FF00FF;
      --futuristic-gradient: linear-gradient(90deg, #FFFFFF 10%, #FF00FF 60%, #E100E1 90%);
      --futuristic-shadow: 0 0 18px #FFFFFF66, 0 0 36px #FF00FF33, 0 0 54px #E100E166;
    }
    body {
      margin: 0;
      background: var(--background);
      color: #fff;
      font-family: 'Cambria', 'Segoe UI', 'Roboto', Arial, sans-serif;
      min-height: 100vh;
      letter-spacing: 0.05em;
      transition: background 0.3s;
    }
    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      background: transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 70px;
      padding-top: 10px;
      border-bottom: none;
      backdrop-filter: blur(6px);
    }
    .tabs {
      display: flex;
      gap: 1.2rem;
    }
    .tab {
      padding: 0.7rem 2.2rem;
      font-size: 1.2rem;
      background: var(--tab-bg);
      border: none;
      border-radius: 35px;
      cursor: pointer;
      font-family: 'Cambria', 'Segoe UI', 'Roboto', Arial, sans-serif;
      font-weight: 700;
      font-style: italic;
      outline: none;
      margin-bottom: 0.5rem;
      color: var(--tab-unselected-font);
      box-shadow: 0 0 10px #E100E188;
      letter-spacing: 0.08em;
      transition: background 0.15s, color 0.15s, box-shadow 0.3s;
      position: relative;
      overflow: hidden;
      border: none;
    }
    .tab.active {
      color: var(--tab-selected-font);
      background: var(--tab-selected-bg);
      box-shadow: 0 0 16px #FFF, 0 0 8px #FF00FF;
      text-shadow: 0 0 7px #FFF, 0 0 10px #FF00FF;
    }
    .tab:not(.active):hover {
      background: var(--tab-selected-bg);
      color: var(--accent);
      box-shadow: 0 0 12px #E100E1;
    }
    header {
      text-align: center;
      padding: 120px 1rem 1.5rem 1rem;
      margin-top: 0;
      margin-bottom: 0;
    }
    header h1 {
      font-size: 3.8rem;
      font-weight: 900;
      letter-spacing: 0.15em;
      margin: 0 0 0.3rem 0;
      font-family: 'Cambria', 'Segoe UI', 'Roboto', Arial, sans-serif;
      color: var(--tab-selected-font);
      text-shadow: 0 0 28px #FFF, 0 0 16px #FF00FF, 0 0 6px #E100E1;
      background: var(--futuristic-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: var(--tab-selected-font);
      filter: drop-shadow(0 0 16px #FF00FF77);
      transition: color 0.3s;
      border-radius: 20px;
      padding: 0.5rem 2rem;
      display: inline-block;
      box-shadow: var(--futuristic-shadow);
    }
    main {
      margin-top: 60px;
      max-width: 980px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 1rem 2rem 1rem;
      font-family: 'Cambria', 'Segoe UI', 'Roboto', Arial, sans-serif;
      color: #fff;
      border-radius: 18px;
      background: transparent;
      box-shadow: 0 0 32px #FF00FF44;
      backdrop-filter: blur(2px);
    }
    .table-container {
      width: 100%;
      overflow-x: auto;
      background: var(--table-bg);
      border-radius: 18px;
      box-shadow: 0 2px 18px #E100E166;
      margin-top: 2.5rem;
      border: none;
    }
    table {
      border-collapse: separate;
      border-spacing: 0;
      width: 100%;
      min-width: 380px;
      font-size: 1.13rem;
      font-family: 'Cambria', 'Segoe UI', 'Roboto', Arial, sans-serif;
      color: #fff;
      background: transparent;
      box-shadow: 0 0 10px #FF00FF44;
      border-radius: 18px;
      overflow: hidden;
    }
    thead {
      background: var(--table-bg);
      position: sticky;
      top: 0;
    }
    th, td {
      padding: 1rem 1.1rem;
      text-align: left;
      white-space: nowrap;
      font-family: 'Cambria', 'Segoe UI', 'Roboto', Arial, sans-serif;
      color: #fff !important;
      letter-spacing: 0.07em;
      border: none;
    }
    th {
      font-weight: 800;
      font-size: 1.15rem;
      background: var(--table-bg);
      color: #FFF !important;
      text-shadow: 0 0 8px #FFF, 0 0 4px #FF00FF;
      border: none;
    }
    tbody tr:nth-child(even) {
      background: var(--row-even);
      transition: background 0.2s;
      border: none;
    }
    tbody tr:nth-child(odd) {
      background: var(--row-odd);
      transition: background 0.2s;
      border: none;
    }
    tbody tr:hover {
      background: var(--row-accent);
      color: #fff;
      box-shadow: 0 0 8px #FF00FF;
      transition: background 0.2s, color 0.2s;
      border: none;
    }
    .spinner,
    .loading-message,
    .error-message {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 2.5rem auto;
      min-height: 120px;
      font-size: 1.35rem;
      color: #fff;
      font-family: 'Cambria', 'Segoe UI', 'Roboto', Arial, sans-serif;
      font-weight: 600;
      text-align: center;
      text-shadow: 0 0 8px #FFF, 0 0 4px #FF00FF;
      letter-spacing: 0.1em;
      background: var(--table-bg);
      border-radius: 12px;
      box-shadow: 0 0 12px #FF00FF44;
      border: none;
    }
    .spinner::after {
      content: '';
      display: inline-block;
      width: 32px;
      height: 32px;
      border: 4px solid #FFF;
      border-radius: 50%;
      border-top: 4px solid transparent;
      animation: spin 1s linear infinite;
      margin-left: 12px;
      vertical-align: middle;
      box-shadow: 0 0 16px #E100E1;
      border: none;
    }
    @keyframes spin {
      100% { transform: rotate(360deg);}
    }
    @media (max-width: 700px) {
      header h1 { font-size: 2.2rem; }
      nav { height: 52px; }
      main { margin-top: 40px; }
      th, td { padding: 0.6rem 0.5rem; font-size: 1rem;}
    }
    @media (max-width: 430px) {
      .table-container { padding: 0; }
      th, td { font-size: 0.93rem;}
      .tab { padding: 0.35rem 0.7rem; font-size: 0.96rem;}
      header { padding-top: 90px; }
    }
  </style>
</head>
<body>
  <nav>
    <div class="tabs">
      <button class="tab active" id="tab-drivers" type="button">Drivers</button>
      <button class="tab" id="tab-constructors" type="button">Constructors</button>
    </div>
  </nav>
  <header>
    <h1 id="site-title">ICE Braking</h1>
  </header>
  <main>
    <div id="content">
      <div class="spinner" id="loading">Loading standings...</div>
    </div>
  </main>
  <script>
    // --- CONFIG ---
    const API = {
      drivers: 'https://api.jolpi.ca/ergast/f1/current/driverStandings.json',
      constructors: 'https://api.jolpi.ca/ergast/f1/current/constructorStandings.json'
    };
    const CACHE_TTL = 300; // seconds (5 min)

    // --- DOM ---
    const tabs = {
      drivers: document.getElementById('tab-drivers'),
      constructors: document.getElementById('tab-constructors')
    };
    const content = document.getElementById('content');
    const siteTitle = document.getElementById('site-title');
    let activeTab = 'drivers';

    // --- Caching helpers ---
    function cacheKey(type) { return `f1_${type}_standings`; }
    function getCache(type) {
      try {
        const item = localStorage.getItem(cacheKey(type));
        if (!item) return null;
        const { data, ts } = JSON.parse(item);
        if (Date.now()/1000 - ts > CACHE_TTL) return null;
        return data;
      } catch { return null; }
    }
    function setCache(type, data) {
      try {
        localStorage.setItem(cacheKey(type), JSON.stringify({ data, ts: Math.floor(Date.now()/1000) }));
      } catch {}
    }

    // --- Render ---
    function showLoading(msg='Loading standings...') {
      content.innerHTML = `<div class="spinner">${msg}</div>`;
    }
    function showError(msg='Unable to load standings') {
      content.innerHTML = `<div class="error-message">${msg}</div>`;
    }

    function renderTable(type, items) {
      let html = '';
      if (type === 'drivers') {
        html += `<div class="table-container"><table><thead>
          <tr>
            <th>Position</th>
            <th>Name</th>
            <th>Team</th>
            <th>Points</th>
          </tr></thead><tbody>`;
        for (const item of items) {
          html += `<tr>
            <td>${item.position}</td>
            <td>${item.name}</td>
            <td>${item.team}</td>
            <td>${item.points}</td>
          </tr>`;
        }
        html += `</tbody></table></div>`;
      } else if (type === 'constructors') {
        html += `<div class="table-container"><table><thead>
          <tr>
            <th>Position</th>
            <th>Name</th>
            <th>Points</th>
          </tr></thead><tbody>`;
        for (const item of items) {
          html += `<tr>
            <td>${item.position}</td>
            <td>${item.name}</td>
            <td>${item.points}</td>
          </tr>`;
        }
        html += `</tbody></table></div>`;
      }
      content.innerHTML = html;
    }

    // --- Data parsing ---
    function parseDrivers(json) {
      try {
        const lists = json?.MRData?.StandingsTable?.StandingsLists;
        if (!lists || !lists.length) return [];
        const drivers = lists[0]?.DriverStandings || [];
        return drivers.map(d => ({
          position: d.positionText || d.position || '-',
          name: `${d.Driver.givenName} ${d.Driver.familyName}`,
          team: d.Constructors[0]?.name || '',
          points: d.points
        }));
      } catch { return []; }
    }
    function parseConstructors(json) {
      try {
        const lists = json?.MRData?.StandingsTable?.StandingsLists;
        if (!lists || !lists.length) return [];
        const constructors = lists[0]?.ConstructorStandings || [];
        return constructors.map(c => ({
          position: c.positionText || c.position || '-',
          name: c.Constructor?.name || '-',
          points: c.points
        }));
      } catch { return []; }
    }

    // --- Fetch ---
    async function fetchStandings(type) {
      let cached = getCache(type);
      if (cached) return cached;
      showLoading();
      try {
        const url = API[type];
        const resp = await fetch(url);
        if (!resp.ok) throw new Error('Network error');
        const json = await resp.json();
        let items = [];
        if (type === 'drivers') items = parseDrivers(json);
        else items = parseConstructors(json);
        if (!items.length) throw new Error('No data');
        setCache(type, items);
        return items;
      } catch {
        showError();
        return null;
      }
    }

    // --- Tab logic ---
    function updateSiteTitleColor() {
      siteTitle.style.color = getComputedStyle(document.querySelector('.tab.active')).color;
      siteTitle.style.textShadow = '0 0 28px #FFF, 0 0 16px #FF00FF, 0 0 6px #E100E1';
      siteTitle.style.background = 'none';
      siteTitle.style.webkitBackgroundClip = '';
      siteTitle.style.backgroundClip = '';
      siteTitle.style.webkitTextFillColor = '';
    }

    async function switchTab(type) {
      if (activeTab === type) return;
      activeTab = type;
      tabs.drivers.classList.toggle('active', type === 'drivers');
      tabs.constructors.classList.toggle('active', type === 'constructors');
      updateSiteTitleColor();
      showLoading();
      let items = getCache(type);
      if (!items) items = await fetchStandings(type);
      if (!items || !items.length) {
        showError();
        return;
      }
      renderTable(type, items);
    }

    function initialLoad() {
      tabs.drivers.classList.add('active');
      tabs.constructors.classList.remove('active');
      activeTab = 'drivers';
      updateSiteTitleColor();
      showLoading();
      fetchStandings('drivers').then(items => {
        if (!items || !items.length) {
          showError();
          return;
        }
        renderTable('drivers', items);
      });
    }

    // --- Event listeners ---
    tabs.drivers.addEventListener('click', () => {
      if (activeTab !== 'drivers') switchTab('drivers');
    });
    tabs.constructors.addEventListener('click', () => {
      if (activeTab !== 'constructors') switchTab('constructors');
    });

    // --- Start ---
    window.addEventListener('DOMContentLoaded', initialLoad);
  </script>
</body>
</html>